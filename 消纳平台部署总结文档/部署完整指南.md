# å…‰ä¼ç”µç«™æ¶ˆçº³è®¡ç®—å¹³å° - å®Œæ•´éƒ¨ç½²æŒ‡å—

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æ›´æ–°æ—¶é—´**: 2025å¹´11æœˆ2æ—¥  
**é¡¹ç›®ä»“åº“**: https://github.com/slingjie/xiaonajisuan  
**å½“å‰åˆ†æ”¯**: feature/work-mode-adjustment

---

## ğŸ“‹ ç›®å½•

1. [éƒ¨ç½²æ¶æ„æ¦‚è¿°](#éƒ¨ç½²æ¶æ„æ¦‚è¿°)
2. [å‰ç½®å‡†å¤‡](#å‰ç½®å‡†å¤‡)
3. [Vercel å‰ç«¯éƒ¨ç½²](#vercel-å‰ç«¯éƒ¨ç½²)
4. [Railway åç«¯éƒ¨ç½²](#railway-åç«¯éƒ¨ç½²)
5. [å‰åç«¯è¿æ¥é…ç½®](#å‰åç«¯è¿æ¥é…ç½®)
6. [éƒ¨ç½²éªŒè¯æµ‹è¯•](#éƒ¨ç½²éªŒè¯æµ‹è¯•)
7. [ç¯å¢ƒå˜é‡é…ç½®è¯¦è§£](#ç¯å¢ƒå˜é‡é…ç½®è¯¦è§£)
8. [é—®é¢˜æ’æŸ¥æŒ‡å—](#é—®é¢˜æ’æŸ¥æŒ‡å—)
9. [å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ](#å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ)
10. [ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–å»ºè®®](#ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–å»ºè®®)
11. [æˆæœ¬åˆ†æä¸å¹³å°å¯¹æ¯”](#æˆæœ¬åˆ†æä¸å¹³å°å¯¹æ¯”)
12. [ç»´æŠ¤ä¸æ›´æ–°](#ç»´æŠ¤ä¸æ›´æ–°)

---

## ğŸ—ï¸ éƒ¨ç½²æ¶æ„æ¦‚è¿°

### æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç”¨æˆ·æµè§ˆå™¨                           â”‚
â”‚          (https://xiaonajisuan.vercel.app)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ HTTP/HTTPS è¯·æ±‚
                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                              â”‚
        â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Vercel CDN     â”‚          â”‚   Railway æœåŠ¡å™¨     â”‚
â”‚   (å‰ç«¯æ‰˜ç®¡)      â”‚          â”‚   (åç«¯æ‰˜ç®¡)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ React App      â”‚          â”‚ â€¢ FastAPI æ¡†æ¶       â”‚
â”‚ â€¢ TypeScript     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ â€¢ Python 3.11.9      â”‚
â”‚ â€¢ Vite æ„å»º      â”‚  CORS    â”‚ â€¢ SQLite æ•°æ®åº“      â”‚
â”‚ â€¢ é™æ€èµ„æº       â”‚  éªŒè¯    â”‚ â€¢ Uvicorn æœåŠ¡å™¨     â”‚
â”‚ â€¢ å…¨çƒ CDN åŠ é€Ÿ  â”‚          â”‚ â€¢ æ–‡ä»¶å­˜å‚¨ /tmp      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  éƒ¨ç½²åœ¨ Vercel Edge             éƒ¨ç½²åœ¨ Railway äº‘ç«¯
  å…è´¹é¢åº¦å……è¶³                   $5/æœˆ å…è´¹é¢åº¦
```

### ä¸ºä»€ä¹ˆé‡‡ç”¨å‰åç«¯åˆ†ç¦»éƒ¨ç½²ï¼Ÿ

#### âŒ åŸå§‹é”™è¯¯æ–¹æ¡ˆï¼ˆå¤±è´¥ï¼‰
```
Vercel Serverless Functions å°è¯•éƒ¨ç½²æ•´ä¸ªåº”ç”¨
â”œâ”€ é—®é¢˜ 1: è¶…æ—¶é™åˆ¶ (10-60ç§’)ï¼Œæ— æ³•è¿è¡Œé•¿æ—¶é—´è®¡ç®—
â”œâ”€ é—®é¢˜ 2: Python Runtime é…ç½®å¤æ‚ï¼Œç‰ˆæœ¬æ”¯æŒæœ‰é™
â”œâ”€ é—®é¢˜ 3: æ— çŠ¶æ€å‡½æ•°ï¼Œæ— æ³•ä¿æŒ SQLite è¿æ¥
â”œâ”€ é—®é¢˜ 4: æ¯æ¬¡éƒ¨ç½²æ•°æ®åº“é‡ç½®ï¼Œæ•°æ®æ— æ³•æŒä¹…åŒ–
â””â”€ ç»“æœ: Function Runtimes must have valid version é”™è¯¯
```

#### âœ… æ­£ç¡®æ–¹æ¡ˆï¼ˆå½“å‰ï¼‰
```
å‰ç«¯ (Vercel)                    åç«¯ (Railway)
â”œâ”€ é™æ€æ–‡ä»¶æ‰˜ç®¡                  â”œâ”€ å®Œæ•´ Python è¿è¡Œæ—¶
â”œâ”€ React SPA                     â”œâ”€ æŒç»­è¿è¡ŒæœåŠ¡
â”œâ”€ CDN å…¨çƒåŠ é€Ÿ                  â”œâ”€ æ— è¶…æ—¶é™åˆ¶
â”œâ”€ è‡ªåŠ¨ HTTPS                    â”œâ”€ SQLite æŒä¹…åŒ–
â”œâ”€ é›¶é…ç½®éƒ¨ç½²                    â”œâ”€ æ–‡ä»¶ç³»ç»Ÿå¯å†™
â””â”€ å®Œå…¨å…è´¹                      â””â”€ $5/æœˆï¼ˆè¶³å¤Ÿä½¿ç”¨ï¼‰
```

---

## ğŸ”§ å‰ç½®å‡†å¤‡

### 1. å¿…éœ€è´¦å·

| å¹³å° | ç”¨é€” | æ³¨å†Œé“¾æ¥ | è´¹ç”¨ |
|------|------|---------|------|
| **GitHub** | ä»£ç æ‰˜ç®¡ | https://github.com | å…è´¹ |
| **Vercel** | å‰ç«¯éƒ¨ç½² | https://vercel.com | å…è´¹ |
| **Railway** | åç«¯éƒ¨ç½² | https://railway.app | $5/æœˆå…è´¹é¢åº¦ |

### 2. æœ¬åœ°ç¯å¢ƒæ£€æŸ¥

```bash
# æ£€æŸ¥ Git ç‰ˆæœ¬
git --version
# è¦æ±‚: >= 2.0

# æ£€æŸ¥ Node.js ç‰ˆæœ¬
node --version
# è¦æ±‚: >= 18.0

# æ£€æŸ¥ Python ç‰ˆæœ¬
python3 --version
# è¦æ±‚: >= 3.9
```

### 3. ä»£ç ä»“åº“å‡†å¤‡

```bash
# 1. ç¡®è®¤å½“å‰åˆ†æ”¯
cd /Users/shilingjie/Desktop/ai/1017å…‰ä¼ç”µç«™æ¶ˆçº³è®¡ç®—å¹³å°
git branch
# åº”æ˜¾ç¤º: * feature/work-mode-adjustment

# 2. ç¡®è®¤ä»£ç å·²æ¨é€åˆ° GitHub
git status
# åº”æ˜¾ç¤º: nothing to commit, working tree clean

# 3. å¦‚æœæœ‰æœªæäº¤çš„æ›´æ”¹
git add .
git commit -m "chore: å‡†å¤‡éƒ¨ç½²"
git push origin feature/work-mode-adjustment
```

### 4. å…³é”®é…ç½®æ–‡ä»¶æ£€æŸ¥

#### vercel.json (å·²ä¿®å¤)
```json
{
  "buildCommand": "cd frontend && npm install && npm run build",
  "outputDirectory": "frontend/dist",
  "framework": "vite",
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ],
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "Access-Control-Allow-Origin",
          "value": "*"
        }
      ]
    }
  ]
}
```

#### Procfile (Railway å¯åŠ¨é…ç½®)
```
web: cd backend && /app/.venv/bin/python -m uvicorn app.main:app --host 0.0.0.0 --port $PORT
```

---

## ğŸš€ Vercel å‰ç«¯éƒ¨ç½²

### æ­¥éª¤ 1: ç™»å½• Vercel

1. è®¿é—® https://vercel.com
2. ç‚¹å‡»å³ä¸Šè§’ **"Sign Up"** æˆ– **"Login"**
3. é€‰æ‹© **"Continue with GitHub"**
4. æˆæƒ Vercel è®¿é—®ä½ çš„ GitHub è´¦å·

### æ­¥éª¤ 2: å¯¼å…¥é¡¹ç›®

1. ç™»å½•åï¼Œç‚¹å‡» **"Add New..."** â†’ **"Project"**
2. åœ¨ "Import Git Repository" é¡µé¢ï¼Œæ‰¾åˆ° **xiaonajisuan** ä»“åº“
3. ç‚¹å‡» **"Import"**

### æ­¥éª¤ 3: é…ç½®é¡¹ç›®

åœ¨ "Configure Project" é¡µé¢ï¼Œ**ç¡®ä¿ä»¥ä¸‹é…ç½®æ­£ç¡®**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Configure Project                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Project Name:        xiaonajisuan           â”‚
â”‚ Framework Preset:    Vite                   â”‚
â”‚ Root Directory:      ./                     â”‚
â”‚ Build Command:       cd frontend &&         â”‚
â”‚                      npm install &&         â”‚
â”‚                      npm run build          â”‚
â”‚ Output Directory:    frontend/dist          â”‚
â”‚ Install Command:     npm --prefix=frontend  â”‚
â”‚                      install                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Environment Variables:  (æš‚æ—¶ç•™ç©º)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          [ Deploy ]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âš ï¸ é‡è¦æç¤º**:
- **Framework Preset**: å¿…é¡»é€‰æ‹© `Vite`
- **Output Directory**: å¿…é¡»æ˜¯ `frontend/dist`
- **Build Command**: å¿…é¡»åŒ…å« `cd frontend`

### æ­¥éª¤ 4: å¼€å§‹éƒ¨ç½²

1. ç¡®è®¤é…ç½®æ— è¯¯åï¼Œç‚¹å‡» **"Deploy"**
2. Vercel å¼€å§‹æ„å»ºï¼Œè¿‡ç¨‹çº¦ 2-3 åˆ†é’Ÿ
3. æŸ¥çœ‹æ„å»ºæ—¥å¿—ï¼Œç¡®ä¿æ— é”™è¯¯

### æ­¥éª¤ 5: è·å–å‰ç«¯ URL

éƒ¨ç½²æˆåŠŸåï¼ŒVercel ä¼šæ˜¾ç¤ºï¼š

```
âœ“ Deployment Ready!
  
Production: https://xiaonajisuan.vercel.app
Preview:    https://xiaonajisuan-git-feature-work-mode-ad-xxx.vercel.app
```

**ğŸ“ è®°ä¸‹ç”Ÿäº§ç¯å¢ƒ URL**: `https://xiaonajisuan.vercel.app`

### æ­¥éª¤ 6: éªŒè¯å‰ç«¯éƒ¨ç½²

```bash
# æ–¹æ³• 1: æµè§ˆå™¨è®¿é—®
æ‰“å¼€: https://xiaonajisuan.vercel.app

# æ–¹æ³• 2: curl æµ‹è¯•
curl -I https://xiaonajisuan.vercel.app
# åº”è¿”å›: HTTP/2 200
```

**é¢„æœŸç»“æœ**:
- âœ… é¡µé¢èƒ½æ­£å¸¸æ‰“å¼€
- âœ… çœ‹åˆ°åº”ç”¨ç•Œé¢ï¼ˆè™½ç„¶æ²¡æœ‰æ•°æ®ï¼‰
- âœ… æµè§ˆå™¨æ§åˆ¶å°æ—  404 é”™è¯¯

---

## ğŸš‚ Railway åç«¯éƒ¨ç½²

### æ–¹æ¡ˆé€‰æ‹©

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | æ¨èåº¦ |
|------|------|------|--------|
| **Railway** | éƒ¨ç½²ç®€å•ã€æ— ç¡çœ ã€æ€§èƒ½å¥½ | $5/æœˆ | â­â­â­â­â­ |
| **Render** | å®Œå…¨å…è´¹ | 15åˆ†é’Ÿæ— æ´»åŠ¨ä¼šç¡çœ  | â­â­â­â­ |
| **Fly.io** | æ€§èƒ½æœ€å¥½ã€å…¨çƒåˆ†å¸ƒ | é…ç½®å¤æ‚ | â­â­â­ |

**æœ¬æŒ‡å—é‡‡ç”¨ Railwayï¼ˆæ¨èæ–¹æ¡ˆï¼‰**

### æ­¥éª¤ 1: åˆ›å»º Railway è´¦å·

1. è®¿é—® https://railway.app
2. ç‚¹å‡» **"Start New Project"**
3. é€‰æ‹© **"Login with GitHub"**
4. æˆæƒ Railway è®¿é—® GitHub

### æ­¥éª¤ 2: åˆ›å»ºæ–°é¡¹ç›®

1. ç‚¹å‡» **"New Project"**
2. é€‰æ‹© **"Deploy from GitHub repo"**
3. åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°å¹¶é€‰æ‹© **xiaonajisuan** ä»“åº“
4. Railway ä¼šè‡ªåŠ¨å¼€å§‹æ£€æµ‹é¡¹ç›®

### æ­¥éª¤ 3: é…ç½®æœåŠ¡

Railway ä¼šè‡ªåŠ¨æ£€æµ‹åˆ° Python é¡¹ç›®ï¼Œä½†éœ€è¦æ‰‹åŠ¨é…ç½®ï¼š

#### 3.1 é…ç½®ç¯å¢ƒå˜é‡

åœ¨ Railway Dashboard ä¸­ï¼š

1. ç‚¹å‡»ä½ çš„æœåŠ¡ï¼ˆserviceï¼‰
2. é€‰æ‹© **"Variables"** æ ‡ç­¾
3. ç‚¹å‡» **"+ New Variable"**
4. é€ä¸ªæ·»åŠ ä»¥ä¸‹å˜é‡ï¼š

```env
# æ•°æ®åº“é…ç½®
DATABASE_URL=sqlite:///./pv_consumption.db

# è°ƒè¯•æ¨¡å¼ï¼ˆç”Ÿäº§ç¯å¢ƒå…³é—­ï¼‰
DEBUG=false

# æ—¥å¿—çº§åˆ«
LOG_LEVEL=INFO

# æ–‡ä»¶å­˜å‚¨è·¯å¾„
STORAGE_PATH=/tmp/pv_storage

# Python è¾“å‡ºç¼“å†²ï¼ˆå¿…éœ€ï¼Œå¦åˆ™çœ‹ä¸åˆ°æ—¥å¿—ï¼‰
PYTHONUNBUFFERED=1

# Python ç‰ˆæœ¬ï¼ˆRailway è‡ªåŠ¨æ£€æµ‹ï¼‰
PYTHON_VERSION=3.11.9

# CORS è·¨åŸŸé…ç½®ï¼ˆæ·»åŠ  Vercel URLï¼‰
CORS_ORIGINS=https://xiaonajisuan.vercel.app,https://xiaonajisuan-git-feature-work-mode-ad-xxx.vercel.app
```

**æ·»åŠ æ–¹å¼**:
```
1. Variable Name: DATABASE_URL
2. Variable Value: sqlite:///./pv_consumption.db
3. ç‚¹å‡» "Add"
4. é‡å¤ä¸Šè¿°æ­¥éª¤æ·»åŠ å…¶ä»–å˜é‡
```

#### 3.2 é…ç½®å¯åŠ¨å‘½ä»¤ï¼ˆå¯é€‰ï¼‰

Railway ä¼šè‡ªåŠ¨æ£€æµ‹ `Procfile`ï¼Œä½†ä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šï¼š

1. åœ¨ Railway Dashboard ä¸­ï¼Œç‚¹å‡» **"Settings"**
2. æ‰¾åˆ° **"Deploy"** éƒ¨åˆ†
3. åœ¨ **"Custom Start Command"** ä¸­è¾“å…¥ï¼š

```bash
cd backend && pip install -r requirements.txt && uvicorn app.main:app --host 0.0.0.0 --port $PORT
```

**æ³¨æ„**: å¦‚æœé¡¹ç›®æ ¹ç›®å½•æœ‰ `Procfile`ï¼ŒRailway ä¼šä¼˜å…ˆä½¿ç”¨å®ƒã€‚

### æ­¥éª¤ 4: éƒ¨ç½²åç«¯

1. é…ç½®å®Œæˆåï¼ŒRailway ä¼šè‡ªåŠ¨å¼€å§‹éƒ¨ç½²
2. ç‚¹å‡» **"Deployments"** æ ‡ç­¾æŸ¥çœ‹è¿›åº¦
3. ç­‰å¾… 3-5 åˆ†é’Ÿå®Œæˆéƒ¨ç½²

### æ­¥éª¤ 5: ç”Ÿæˆå…¬å¼€åŸŸå

éƒ¨ç½²å®Œæˆåï¼Œéœ€è¦ç”Ÿæˆå…¬å¼€è®¿é—®åŸŸåï¼š

1. åœ¨ Railway Dashboard ä¸­ï¼Œç‚¹å‡» **"Settings"**
2. æ‰¾åˆ° **"Domains"** éƒ¨åˆ†
3. ç‚¹å‡» **"Generate Domain"**
4. Railway ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŸŸåï¼Œä¾‹å¦‚ï¼š
   ```
   https://meticulous-inspiration-production.up.railway.app
   ```

**ğŸ“ è®°ä¸‹è¿™ä¸ªåç«¯ URL**ï¼Œåé¢é…ç½®å‰ç«¯æ—¶éœ€è¦ç”¨åˆ°ã€‚

### æ­¥éª¤ 6: éªŒè¯åç«¯éƒ¨ç½²

```bash
# æ–¹æ³• 1: æµ‹è¯•å¥åº·æ£€æŸ¥ç«¯ç‚¹
curl https://your-backend-url.railway.app/api/healthz

# æ–¹æ³• 2: æµ‹è¯• API ç«¯ç‚¹
curl https://your-backend-url.railway.app/api/pv/records

# é¢„æœŸå“åº”
{"total_records":0,"capacity_kw":1.0,"months":[]}
```

### æ­¥éª¤ 7: æŸ¥çœ‹æ—¥å¿—ï¼ˆæ’æŸ¥é—®é¢˜ç”¨ï¼‰

å¦‚æœéƒ¨ç½²å¤±è´¥æˆ–æœ‰é—®é¢˜ï¼š

```bash
# æ–¹æ³• 1: Railway Dashboard
ç‚¹å‡»æœåŠ¡ â†’ "Deployments" â†’ é€‰æ‹©æœ€æ–°éƒ¨ç½² â†’ "View Logs"

# æ–¹æ³• 2: Railway CLIï¼ˆéœ€å®‰è£…ï¼‰
npm install -g @railway/cli
railway login
railway logs --tail
```

---

## ğŸ”— å‰åç«¯è¿æ¥é…ç½®

### æ­¥éª¤ 1: æ›´æ–° Vercel ç¯å¢ƒå˜é‡

1. è®¿é—® Vercel Dashboard: https://vercel.com/dashboard
2. é€‰æ‹© **xiaonajisuan** é¡¹ç›®
3. ç‚¹å‡» **"Settings"** æ ‡ç­¾
4. é€‰æ‹©å·¦ä¾§ **"Environment Variables"**
5. ç‚¹å‡» **"Add New"**

#### æ·»åŠ  API URL ç¯å¢ƒå˜é‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Add Environment Variable                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Name:                                       â”‚
â”‚ VITE_API_URL                                â”‚
â”‚                                             â”‚
â”‚ Value:                                      â”‚
â”‚ https://your-backend-url.railway.app/api   â”‚
â”‚                                             â”‚
â”‚ Environments: (å…¨é€‰)                        â”‚
â”‚ â˜‘ Production                                â”‚
â”‚ â˜‘ Preview                                   â”‚
â”‚ â˜‘ Development                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          [ Save ]                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âš ï¸ æ³¨æ„**:
- **å˜é‡å**: å¿…é¡»æ˜¯ `VITE_API_URL`ï¼ˆVite è¦æ±‚å‰ç¼€ `VITE_`ï¼‰
- **å€¼**: Railway URL + `/api` è·¯å¾„
- **ç¯å¢ƒ**: å»ºè®®å…¨é€‰ï¼ˆProduction, Preview, Developmentï¼‰

### æ­¥éª¤ 2: è§¦å‘ Vercel é‡æ–°éƒ¨ç½²

æ·»åŠ ç¯å¢ƒå˜é‡åï¼ŒVercel **ä¸ä¼š**è‡ªåŠ¨é‡æ–°éƒ¨ç½²ã€‚éœ€è¦æ‰‹åŠ¨è§¦å‘ï¼š

#### æ–¹æ³• 1: é€šè¿‡ Dashboard é‡æ–°éƒ¨ç½²
```
1. Vercel Dashboard â†’ xiaonajisuan é¡¹ç›®
2. ç‚¹å‡» "Deployments" æ ‡ç­¾
3. æ‰¾åˆ°æœ€æ–°çš„ Production éƒ¨ç½²
4. ç‚¹å‡»å³ä¾§ "..." èœå•
5. é€‰æ‹© "Redeploy"
6. é€‰æ‹© "Use existing Build Cache"
7. ç‚¹å‡» "Redeploy"
```

#### æ–¹æ³• 2: æ¨é€ä»£ç è§¦å‘ï¼ˆæ¨èï¼‰
```bash
# æ·»åŠ ä¸€ä¸ªç©ºæäº¤è§¦å‘éƒ¨ç½²
cd /Users/shilingjie/Desktop/ai/1017å…‰ä¼ç”µç«™æ¶ˆçº³è®¡ç®—å¹³å°
git commit --allow-empty -m "chore: è§¦å‘ Vercel é‡æ–°éƒ¨ç½²"
git push origin feature/work-mode-adjustment
```

### æ­¥éª¤ 3: æ›´æ–°åç«¯ CORS é…ç½®

ç¡®ä¿åç«¯å…è®¸å‰ç«¯è·¨åŸŸè®¿é—®ï¼š

#### æ£€æŸ¥ backend/app/core/config.py

```python
# æ–‡ä»¶ä½ç½®: backend/app/core/config.py
class Settings(BaseSettings):
    # ...
    allowed_origins: List[str] = [
        "http://localhost:5173",
        "http://127.0.0.1:5173",
        # å…¶ä»–æœ¬åœ°å¼€å‘ URL...
    ]
    
    def __init__(self, **data):
        super().__init__(**data)
        # è‡ªåŠ¨ä»ç¯å¢ƒå˜é‡ CORS_ORIGINS æ·»åŠ 
        cors_origins = os.getenv("CORS_ORIGINS", "")
        if cors_origins:
            origins = [o.strip() for o in cors_origins.split(",")]
            for origin in origins:
                if origin and origin not in self.allowed_origins:
                    self.allowed_origins.append(origin)
```

**éªŒè¯ CORS_ORIGINS ç¯å¢ƒå˜é‡**:

ç¡®ä¿ Railway çš„ `CORS_ORIGINS` åŒ…å«æ‰€æœ‰ Vercel éƒ¨ç½² URLï¼š

```env
CORS_ORIGINS=https://xiaonajisuan.vercel.app,https://xiaonajisuan-git-feature-work-mode-ad-xxx.vercel.app
```

**å¦‚æœåç»­æ·»åŠ æ–°çš„ Preview éƒ¨ç½² URL**ï¼Œéœ€è¦æ›´æ–° Railway çš„ç¯å¢ƒå˜é‡å¹¶é‡æ–°éƒ¨ç½²ã€‚

---

## âœ… éƒ¨ç½²éªŒè¯æµ‹è¯•

### æµ‹è¯• 1: å‰ç«¯è®¿é—®æµ‹è¯•

```bash
# 1. æµè§ˆå™¨æ‰“å¼€å‰ç«¯
https://xiaonajisuan.vercel.app

# 2. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
# 3. æ£€æŸ¥ Console æ˜¯å¦æœ‰é”™è¯¯
# 4. æ£€æŸ¥ Network æ ‡ç­¾ï¼ŒæŸ¥çœ‹ API è¯·æ±‚
```

**é¢„æœŸç»“æœ**:
- âœ… é¡µé¢æ­£å¸¸åŠ è½½
- âœ… æ—  JavaScript é”™è¯¯
- âœ… æ—  CORS é”™è¯¯
- âœ… Network æ˜¾ç¤ºè¯·æ±‚å‘é€åˆ° Railway URL

### æµ‹è¯• 2: API è¿æ¥æµ‹è¯•

åœ¨æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12 â†’ Consoleï¼‰è¿è¡Œï¼š

```javascript
// æµ‹è¯•å¥åº·æ£€æŸ¥
fetch('https://your-backend-url.railway.app/api/healthz')
  .then(r => r.json())
  .then(d => console.log('âœ“ åç«¯å¥åº·æ£€æŸ¥é€šè¿‡:', d))
  .catch(e => console.error('âœ— åç«¯è¿æ¥å¤±è´¥:', e));

// æµ‹è¯•å…‰ä¼è®°å½• API
fetch('https://your-backend-url.railway.app/api/pv/records')
  .then(r => r.json())
  .then(d => console.log('âœ“ API æ•°æ®:', d))
  .catch(e => console.error('âœ— API é”™è¯¯:', e));
```

**é¢„æœŸå“åº”**:
```javascript
âœ“ åç«¯å¥åº·æ£€æŸ¥é€šè¿‡: {status: "ok", service: "PV Consumption Platform"}
âœ“ API æ•°æ®: {total_records: 0, capacity_kw: 1, months: []}
```

### æµ‹è¯• 3: å®Œæ•´åŠŸèƒ½æµ‹è¯•

#### 3.1 æ•°æ®å¯¼å…¥æµ‹è¯•

1. æ‰“å¼€ https://xiaonajisuan.vercel.app/data-import
2. ä¸Šä¼ å…‰ä¼å‘ç”µæ•°æ® Excel æ–‡ä»¶
3. æ£€æŸ¥æ˜¯å¦æˆåŠŸå¯¼å…¥

#### 3.2 å‚æ•°é…ç½®æµ‹è¯•

1. è®¿é—® /parameters é¡µé¢
2. é…ç½®åˆ†æ—¶ç”µä»·å‚æ•°
3. ä¿å­˜é…ç½®

#### 3.3 è®¡ç®—æµ‹è¯•

1. è®¿é—®è®¡ç®—é¡µé¢
2. é€‰æ‹©è´Ÿè·é…ç½®
3. æ‰§è¡Œæ¶ˆçº³è®¡ç®—
4. æŸ¥çœ‹ç»“æœ

#### 3.4 æŠ¥å‘Šå¯¼å‡ºæµ‹è¯•

1. è®¿é—®æŠ¥å‘Šé¡µé¢
2. å¯¼å‡ºæœˆåº¦æŠ¥å‘Š
3. æ£€æŸ¥ Excel æ–‡ä»¶

### æµ‹è¯• 4: æ€§èƒ½æµ‹è¯•

```bash
# æµ‹è¯•é¡µé¢åŠ è½½æ—¶é—´
curl -w "@curl-format.txt" -o /dev/null -s https://xiaonajisuan.vercel.app

# æµ‹è¯• API å“åº”æ—¶é—´
time curl -s https://your-backend-url.railway.app/api/pv/records
```

**é¢„æœŸæ€§èƒ½**:
- å‰ç«¯é¦–æ¬¡åŠ è½½: < 2 ç§’
- API å“åº”æ—¶é—´: < 500 ms
- é™æ€èµ„æº: < 100 msï¼ˆCDN åŠ é€Ÿï¼‰

---

## ğŸ” ç¯å¢ƒå˜é‡é…ç½®è¯¦è§£

### Vercel ç¯å¢ƒå˜é‡

| å˜é‡å | å€¼ | è¯´æ˜ | å¿…éœ€ |
|--------|-----|------|------|
| `VITE_API_URL` | `https://your-backend.railway.app/api` | åç«¯ API åŸºç¡€ URL | âœ… æ˜¯ |

**é…ç½®ä½ç½®**: Vercel Dashboard â†’ Project â†’ Settings â†’ Environment Variables

**æ³¨æ„äº‹é¡¹**:
1. å˜é‡åå¿…é¡»ä»¥ `VITE_` å¼€å¤´ï¼ˆVite æ„å»ºè¦æ±‚ï¼‰
2. ä¿®æ”¹åéœ€è¦é‡æ–°éƒ¨ç½²æ‰èƒ½ç”Ÿæ•ˆ
3. å»ºè®®åœ¨æ‰€æœ‰ç¯å¢ƒï¼ˆProduction, Preview, Developmentï¼‰ä¸­é…ç½®

### Railway ç¯å¢ƒå˜é‡

| å˜é‡å | å€¼ | è¯´æ˜ | å¿…éœ€ |
|--------|-----|------|------|
| `DATABASE_URL` | `sqlite:///./pv_consumption.db` | æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸² | âœ… æ˜¯ |
| `DEBUG` | `false` | è°ƒè¯•æ¨¡å¼ï¼ˆç”Ÿäº§ç¯å¢ƒå…³é—­ï¼‰ | âœ… æ˜¯ |
| `LOG_LEVEL` | `INFO` | æ—¥å¿—çº§åˆ« (DEBUG/INFO/WARNING/ERROR) | âœ… æ˜¯ |
| `STORAGE_PATH` | `/tmp/pv_storage` | æ–‡ä»¶å­˜å‚¨è·¯å¾„ | âœ… æ˜¯ |
| `PYTHONUNBUFFERED` | `1` | Python è¾“å‡ºä¸ç¼“å†²ï¼ˆå®æ—¶æ—¥å¿—ï¼‰ | âœ… æ˜¯ |
| `PYTHON_VERSION` | `3.11.9` | Python ç‰ˆæœ¬ï¼ˆRailway è‡ªåŠ¨æ£€æµ‹ï¼‰ | âš ï¸ å¯é€‰ |
| `CORS_ORIGINS` | `https://xiaonajisuan.vercel.app,...` | CORS è·¨åŸŸç™½åå• | âœ… æ˜¯ |

**é…ç½®ä½ç½®**: Railway Dashboard â†’ Service â†’ Variables

**CORS_ORIGINS æ ¼å¼**:
```
# å•ä¸ª URL
CORS_ORIGINS=https://xiaonajisuan.vercel.app

# å¤šä¸ª URLï¼ˆé€—å·åˆ†éš”ï¼Œæ— ç©ºæ ¼ï¼‰
CORS_ORIGINS=https://xiaonajisuan.vercel.app,https://xiaonajisuan-git-xxx.vercel.app
```

### ç¯å¢ƒå˜é‡ä¼˜å…ˆçº§

```
1. Railway/Vercel å¹³å°é…ç½®çš„ç¯å¢ƒå˜é‡ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. .env æ–‡ä»¶ä¸­çš„é…ç½®ï¼ˆæœ¬åœ°å¼€å‘ç”¨ï¼‰
3. config.py ä¸­çš„é»˜è®¤å€¼ï¼ˆå…œåº•ï¼‰
```

### æ•æ„Ÿä¿¡æ¯ä¿æŠ¤

**âš ï¸ é‡è¦**: æ°¸è¿œä¸è¦æŠŠæ•æ„Ÿä¿¡æ¯æäº¤åˆ° Git

```bash
# .gitignore åº”åŒ…å«
.env
.env.local
.env.production
*.db
storage/
```

---

## ğŸ”§ é—®é¢˜æ’æŸ¥æŒ‡å—

### é—®é¢˜åˆ†ç±»ä¸å®šä½

#### é—®é¢˜ 1: å‰ç«¯æ‰“ä¸å¼€ (404 Not Found)

**ç—‡çŠ¶**:
- è®¿é—® Vercel URL è¿”å› 404
- æˆ–è€…æŸäº›è·¯ç”±ï¼ˆå¦‚ `/data-import`ï¼‰è¿”å› 404

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. æ£€æŸ¥ Vercel éƒ¨ç½²çŠ¶æ€
è®¿é—® Vercel Dashboard â†’ Deployments
æŸ¥çœ‹æœ€æ–°éƒ¨ç½²æ˜¯å¦æˆåŠŸ

# 2. æ£€æŸ¥ vercel.json é…ç½®
cat vercel.json | grep rewrites -A 5
# åº”è¯¥åŒ…å« rewrites é…ç½®
```

**è§£å†³æ–¹æ¡ˆ**:

å¦‚æœç¼ºå°‘ rewrites é…ç½®ï¼Œæ·»åŠ åˆ° `vercel.json`:

```json
{
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

#### é—®é¢˜ 2: å‰ç«¯èƒ½æ‰“å¼€ä½†æ— æ•°æ®

**ç—‡çŠ¶**:
- å‰ç«¯é¡µé¢æ­£å¸¸æ˜¾ç¤º
- ä½†æ•°æ®åŠ è½½å¤±è´¥
- æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤ºç½‘ç»œé”™è¯¯

**æ’æŸ¥æ­¥éª¤**:

```javascript
// 1. æµè§ˆå™¨æ§åˆ¶å°æ£€æŸ¥ API URL
console.log(import.meta.env.VITE_API_URL);
// åº”è¯¥æ˜¾ç¤º: https://your-backend.railway.app/api

// 2. æµ‹è¯•åç«¯è¿æ¥
fetch('https://your-backend.railway.app/api/healthz')
  .then(r => r.text())
  .then(console.log)
  .catch(console.error);
```

**è§£å†³æ–¹æ¡ˆ**:

1. æ£€æŸ¥ Vercel ç¯å¢ƒå˜é‡ `VITE_API_URL` æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ Railway æœåŠ¡æ­£åœ¨è¿è¡Œï¼ˆDashboard æ˜¾ç¤º "Active"ï¼‰
3. æ£€æŸ¥ Railway URL æ˜¯å¦å¯è®¿é—®

#### é—®é¢˜ 3: CORS é”™è¯¯

**ç—‡çŠ¶**:
```
Access to fetch at 'https://backend.railway.app/api/...' from origin 
'https://xiaonajisuan.vercel.app' has been blocked by CORS policy
```

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. æ£€æŸ¥ Railway çš„ CORS_ORIGINS ç¯å¢ƒå˜é‡
# Railway Dashboard â†’ Variables â†’ CORS_ORIGINS
# åº”åŒ…å«: https://xiaonajisuan.vercel.app

# 2. æµ‹è¯• CORS é¢„æ£€è¯·æ±‚
curl -X OPTIONS \
  -H "Origin: https://xiaonajisuan.vercel.app" \
  -H "Access-Control-Request-Method: GET" \
  https://your-backend.railway.app/api/pv/records
```

**è§£å†³æ–¹æ¡ˆ**:

1. æ›´æ–° Railway ç¯å¢ƒå˜é‡:
   ```
   CORS_ORIGINS=https://xiaonajisuan.vercel.app,https://xiaonajisuan-git-xxx.vercel.app
   ```

2. å¦‚æœè¿˜ä¸è¡Œï¼Œæ‰‹åŠ¨ç¼–è¾‘ `backend/app/core/config.py`:
   ```python
   allowed_origins: List[str] = [
       "https://xiaonajisuan.vercel.app",
       "http://localhost:5173",
   ]
   ```

3. æ¨é€ä»£ç è§¦å‘ Railway é‡æ–°éƒ¨ç½²

#### é—®é¢˜ 4: Railway éƒ¨ç½²å¤±è´¥

**ç—‡çŠ¶**:
- Railway Dashboard æ˜¾ç¤º "Failed" æˆ– "Crashed"
- æœåŠ¡æ— æ³•å¯åŠ¨

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. æŸ¥çœ‹ Railway éƒ¨ç½²æ—¥å¿—
Railway Dashboard â†’ Deployments â†’ æœ€æ–°éƒ¨ç½² â†’ View Logs

# 2. å¸¸è§é”™è¯¯ä¿¡æ¯
- "ModuleNotFoundError": ä¾èµ–å®‰è£…å¤±è´¥
- "No module named 'app'": å·¥ä½œç›®å½•é”™è¯¯
- "Address already in use": ç«¯å£é…ç½®é”™è¯¯
```

**è§£å†³æ–¹æ¡ˆ**:

æ ¹æ®é”™è¯¯ç±»å‹ï¼š

**A. ä¾èµ–å®‰è£…å¤±è´¥**
```bash
# æ£€æŸ¥ requirements.txt
cat backend/requirements.txt

# ç¡®ä¿åŒ…å«æ‰€æœ‰ä¾èµ–
fastapi==0.115.0
uvicorn[standard]==0.30.3
sqlmodel==0.0.16
# ...
```

**B. æ¨¡å—å¯¼å…¥é”™è¯¯**
```bash
# æ£€æŸ¥ Procfile æˆ–å¯åŠ¨å‘½ä»¤
cat Procfile
# åº”è¯¥æ˜¯: web: cd backend && ...
```

**C. ç«¯å£é…ç½®é”™è¯¯**
```bash
# ç¡®ä¿ä½¿ç”¨ $PORT ç¯å¢ƒå˜é‡
uvicorn app.main:app --host 0.0.0.0 --port $PORT
# ä¸è¦ç¡¬ç¼–ç ç«¯å£å·
```

#### é—®é¢˜ 5: æ–‡ä»¶ä¸Šä¼ å¤±è´¥

**ç—‡çŠ¶**:
- ä¸Šä¼  Excel æ–‡ä»¶æ—¶æ˜¾ç¤º 500 é”™è¯¯
- æˆ–ä¸Šä¼ åæ— æ³•è¯»å–

**æ’æŸ¥æ­¥éª¤**:

```bash
# 1. æ£€æŸ¥ Railway æ—¥å¿—
Railway Dashboard â†’ Logs
# æœç´¢ "storage" æˆ– "upload" ç›¸å…³é”™è¯¯

# 2. æ£€æŸ¥ STORAGE_PATH ç¯å¢ƒå˜é‡
# Railway Dashboard â†’ Variables â†’ STORAGE_PATH
# åº”è¯¥æ˜¯: /tmp/pv_storage
```

**è§£å†³æ–¹æ¡ˆ**:

1. ç¡®ä¿ `STORAGE_PATH=/tmp/pv_storage`
2. æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆRailway é»˜è®¤é™åˆ¶ï¼‰
3. æŸ¥çœ‹åç«¯æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

#### é—®é¢˜ 6: æ•°æ®åº“è¿æ¥å¤±è´¥

**ç—‡çŠ¶**:
- API è¿”å›æ•°æ®åº“ç›¸å…³é”™è¯¯
- æˆ–æ— æ³•ä¿å­˜æ•°æ®

**æ’æŸ¥æ­¥éª¤**:

```bash
# æ£€æŸ¥ DATABASE_URL
# Railway Dashboard â†’ Variables â†’ DATABASE_URL
# åº”è¯¥æ˜¯: sqlite:///./pv_consumption.db

# æœ¬åœ°æµ‹è¯•æ•°æ®åº“
cd backend
python3 -c "from app.core.database import init_db; init_db(); print('OK')"
```

**è§£å†³æ–¹æ¡ˆ**:

1. SQLite æ–‡ä»¶è·¯å¾„ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼š`sqlite:///./pv_consumption.db`
2. ç¡®ä¿ Railway æœ‰å†™æƒé™ï¼ˆ`/tmp` ç›®å½•ï¼‰
3. è€ƒè™‘å‡çº§åˆ° PostgreSQLï¼ˆRailway å†…ç½®æ”¯æŒï¼‰

---

## âš ï¸ å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ

### é”™è¯¯ 1: Function Runtimes must have valid version

```
Error: Function Runtimes must have a valid version, 
for example `now-php@1.0.0`.
```

**åŸå› **: Vercel çš„ Serverless Functions é…ç½®é”™è¯¯

**è§£å†³**: ç®€åŒ– `vercel.json`ï¼Œç§»é™¤ Python Runtime é…ç½®

```json
{
  "buildCommand": "cd frontend && npm install && npm run build",
  "outputDirectory": "frontend/dist",
  "framework": "vite"
}
```

**çŠ¶æ€**: âœ… å·²ä¿®å¤

---

### é”™è¯¯ 2: Build failed with exit code 1

**ç—‡çŠ¶**: Vercel æ„å»ºå¤±è´¥

**å¸¸è§åŸå› **:
1. `npm install` å¤±è´¥ï¼ˆä¾èµ–é—®é¢˜ï¼‰
2. `npm run build` å¤±è´¥ï¼ˆTypeScript é”™è¯¯ï¼‰
3. Output Directory é…ç½®é”™è¯¯

**æ’æŸ¥**:

```bash
# æœ¬åœ°æµ‹è¯•æ„å»º
cd frontend
npm install
npm run build

# æ£€æŸ¥ dist ç›®å½•
ls -la dist/
```

**è§£å†³**:

1. ä¿®å¤ TypeScript é”™è¯¯
2. ç¡®ä¿ `frontend/dist` ç›®å½•ç”Ÿæˆ
3. æ£€æŸ¥ Vercel é…ç½®ä¸­çš„ Output Directory

---

### é”™è¯¯ 3: Railway æ˜¾ç¤º "Crashed"

**ç—‡çŠ¶**: Railway æœåŠ¡æ— æ³•å¯åŠ¨

**æ’æŸ¥**:

```bash
# æŸ¥çœ‹ Railway æ—¥å¿—
Railway Dashboard â†’ Service â†’ Logs

# å¸¸è§é”™è¯¯æ¨¡å¼
- "Python3 æœªå®‰è£…": Railway æœªè¯†åˆ«ä¸º Python é¡¹ç›®
- "ModuleNotFoundError": ä¾èµ–å®‰è£…å¤±è´¥
- "Port already in use": ç«¯å£å†²çª
```

**è§£å†³**:

**A. Railway æœªè¯†åˆ« Python**

åˆ›å»ºæˆ–æ£€æŸ¥ `Procfile`:
```
web: cd backend && pip install -r requirements.txt && uvicorn app.main:app --host 0.0.0.0 --port $PORT
```

**B. ä¾èµ–é—®é¢˜**

ç¡®ä¿ `backend/requirements.txt` å®Œæ•´ä¸”ç‰ˆæœ¬å…¼å®¹ï¼š
```
fastapi==0.115.0
uvicorn[standard]==0.30.3
sqlmodel==0.0.16
sqlalchemy==2.0.23
pydantic-settings==2.2.1
pandas==2.2.2
openpyxl==3.1.5
python-multipart==0.0.9
aiofiles==23.2.1
```

**C. ç«¯å£é…ç½®**

ç¡®ä¿ä½¿ç”¨ `$PORT` å˜é‡ï¼ˆRailway åŠ¨æ€åˆ†é…ï¼‰ï¼š
```bash
uvicorn app.main:app --host 0.0.0.0 --port $PORT
```

---

### é”™è¯¯ 4: 504 Gateway Timeout

**ç—‡çŠ¶**: API è¯·æ±‚è¶…æ—¶

**åŸå› **:
1. Railway æœåŠ¡å¯åŠ¨æ…¢ï¼ˆå†·å¯åŠ¨ï¼‰
2. è®¡ç®—ä»»åŠ¡è€—æ—¶è¿‡é•¿
3. æ•°æ®åº“æŸ¥è¯¢æ…¢

**è§£å†³**:

1. **å†·å¯åŠ¨**: ç­‰å¾… 30-60 ç§’åé‡è¯•
2. **é•¿æ—¶é—´è®¡ç®—**: è€ƒè™‘å¼‚æ­¥ä»»åŠ¡æˆ–åˆ†é¡µå¤„ç†
3. **æ•°æ®åº“ä¼˜åŒ–**: æ·»åŠ ç´¢å¼•ã€ä¼˜åŒ–æŸ¥è¯¢

---

### é”™è¯¯ 5: å‰ç«¯è·¯ç”± 404

**ç—‡çŠ¶**: åˆ·æ–°é¡µé¢æˆ–ç›´æ¥è®¿é—® `/data-import` è¿”å› 404

**åŸå› **: Vercel æ²¡æœ‰é…ç½® SPA è·¯ç”±é‡å†™

**è§£å†³**: åœ¨ `vercel.json` æ·»åŠ  rewrites

```json
{
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

**éªŒè¯**:
```bash
curl -I https://xiaonajisuan.vercel.app/data-import
# åº”è¿”å› 200ï¼Œä¸æ˜¯ 404
```

---

## ğŸš€ ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–å»ºè®®

### 1. æ€§èƒ½ä¼˜åŒ–

#### å‰ç«¯ä¼˜åŒ–

```typescript
// ä»£ç åˆ†å‰²ï¼ˆfrontend/src/App.tsxï¼‰
import { lazy, Suspense } from 'react';

const DataImport = lazy(() => import('./pages/DataImport'));
const Parameters = lazy(() => import('./pages/Parameters'));

// ä½¿ç”¨ Suspense åŒ…è£¹
<Suspense fallback={<Loading />}>
  <DataImport />
</Suspense>
```

#### åç«¯ä¼˜åŒ–

```python
# æ·»åŠ ç¼“å­˜ï¼ˆbackend/app/services/calculation.pyï¼‰
from functools import lru_cache

@lru_cache(maxsize=100)
def calculate_consumption(profile_id: int, params: dict):
    # ç¼“å­˜è®¡ç®—ç»“æœ
    pass
```

### 2. æ•°æ®åº“å‡çº§

**å½“å‰**: SQLiteï¼ˆé€‚åˆå¼€å‘å’Œå°è§„æ¨¡ï¼‰  
**æ¨è**: PostgreSQLï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

**Railway æ·»åŠ  PostgreSQL**:

```bash
# 1. Railway Dashboard â†’ é¡¹ç›®
# 2. ç‚¹å‡» "+ New" â†’ "Database" â†’ "Add PostgreSQL"
# 3. Railway è‡ªåŠ¨ç”Ÿæˆ DATABASE_URL
# 4. æ›´æ–°åç«¯ä»£ç æ”¯æŒ PostgreSQL
```

**è¿ç§»æ­¥éª¤**:

```python
# backend/app/core/config.py
database_url: str = os.getenv(
    "DATABASE_URL", 
    "sqlite:///./pv_consumption.db"
).replace("postgres://", "postgresql://")  # Railway å…¼å®¹
```

### 3. æ–‡ä»¶å­˜å‚¨ä¼˜åŒ–

**å½“å‰**: æœ¬åœ° `/tmp` ç›®å½•ï¼ˆä¸´æ—¶ï¼‰  
**æ¨è**: äº‘å­˜å‚¨ï¼ˆæŒä¹…åŒ–ï¼‰

**é€‰é¡¹**:
- AWS S3
- é˜¿é‡Œäº‘ OSS
- Cloudflare R2ï¼ˆå…è´¹é¢åº¦å¤§ï¼‰

### 4. ç›‘æ§ä¸æ—¥å¿—

#### Vercel Analytics

```bash
# 1. Vercel Dashboard â†’ é¡¹ç›® â†’ Analytics
# 2. å¯ç”¨ "Web Analytics"
# 3. æŸ¥çœ‹è®¿é—®é‡ã€æ€§èƒ½æŒ‡æ ‡
```

#### Railway æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
railway logs --tail

# æœç´¢é”™è¯¯
railway logs | grep ERROR
```

#### Sentry é”™è¯¯è¿½è¸ª

```bash
# 1. æ³¨å†Œ Sentry: https://sentry.io
# 2. åˆ›å»ºé¡¹ç›®
# 3. å‰åç«¯é›†æˆ Sentry SDK
```

### 5. å®‰å…¨åŠ å›º

#### API è®¤è¯

```python
# æ·»åŠ  API Key è®¤è¯
from fastapi import Security, HTTPException
from fastapi.security import APIKeyHeader

api_key_header = APIKeyHeader(name="X-API-Key")

def verify_api_key(api_key: str = Security(api_key_header)):
    if api_key != os.getenv("API_KEY"):
        raise HTTPException(status_code=403, detail="Invalid API Key")
    return api_key
```

#### Rate Limiting

```python
# ä½¿ç”¨ slowapi
from slowapi import Limiter
from slowapi.util import get_remote_address

limiter = Limiter(key_func=get_remote_address)

@app.get("/api/pv/records")
@limiter.limit("10/minute")
def get_records():
    pass
```

### 6. CI/CD è‡ªåŠ¨åŒ–

**GitHub Actions ç¤ºä¾‹**:

```yaml
# .github/workflows/deploy.yml
name: Deploy

on:
  push:
    branches: [main, feature/work-mode-adjustment]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run tests
        run: |
          cd backend
          pip install -r requirements.txt
          pytest

  deploy:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to Vercel
        run: vercel --prod --token ${{ secrets.VERCEL_TOKEN }}
      - name: Deploy to Railway
        run: railway up --token ${{ secrets.RAILWAY_TOKEN }}
```

---

## ğŸ’° æˆæœ¬åˆ†æä¸å¹³å°å¯¹æ¯”

### å½“å‰æ–¹æ¡ˆæˆæœ¬

| æœåŠ¡ | è´¹ç”¨ | è¯´æ˜ |
|------|------|------|
| **Vercel** | Â¥0/æœˆ | å…è´¹é¢åº¦è¶³å¤Ÿ |
| **Railway** | $5/æœˆ | å…è´¹é¢åº¦ï¼Œè¶…å‡ºåæŒ‰é‡ä»˜è´¹ |
| **GitHub** | Â¥0/æœˆ | å…¬å¼€ä»“åº“å…è´¹ |
| **æ€»è®¡** | **â‰ˆ Â¥35/æœˆ** | Railway $5 â‰ˆ Â¥35 |

### æˆæœ¬ä¼˜åŒ–æ–¹æ¡ˆ

#### æ–¹æ¡ˆ 1: å®Œå…¨å…è´¹ï¼ˆä½¿ç”¨ Renderï¼‰

| æœåŠ¡ | è´¹ç”¨ | è¯´æ˜ |
|------|------|------|
| **Vercel** | Â¥0/æœˆ | å‰ç«¯ |
| **Render** | Â¥0/æœˆ | åç«¯ï¼ˆæœ‰ç¡çœ ï¼‰ |
| **æ€»è®¡** | **Â¥0/æœˆ** | å®Œå…¨å…è´¹ |

**ç¼ºç‚¹**: Render å…è´¹å±‚ 15 åˆ†é’Ÿæ— æ´»åŠ¨ä¼šç¡çœ ï¼Œå”¤é†’éœ€è¦ 10-20 ç§’ã€‚

#### æ–¹æ¡ˆ 2: æ€§èƒ½ä¼˜å…ˆï¼ˆä½¿ç”¨ Fly.ioï¼‰

| æœåŠ¡ | è´¹ç”¨ | è¯´æ˜ |
|------|------|------|
| **Vercel** | Â¥0/æœˆ | å‰ç«¯ |
| **Fly.io** | Â¥0-200/æœˆ | åç«¯ï¼ŒæŒ‰ä½¿ç”¨é‡ |
| **æ€»è®¡** | **Â¥0-200/æœˆ** | å…è´¹é¢åº¦ + è¶…å‡ºä»˜è´¹ |

**ä¼˜ç‚¹**: å…¨çƒåˆ†å¸ƒã€æ— å†·å¯åŠ¨ã€æ€§èƒ½æœ€å¥½ã€‚

### å¹³å°è¯¦ç»†å¯¹æ¯”

| å¹³å° | å…è´¹é¢åº¦ | éƒ¨ç½²éš¾åº¦ | å†·å¯åŠ¨ | ç¨³å®šæ€§ | æ¨èåº¦ |
|------|---------|---------|--------|--------|--------|
| **Railway** | $5/æœˆ | â­ ç®€å• | æ—  | â­â­â­â­â­ | â­â­â­â­â­ |
| **Render** | å®Œå…¨å…è´¹ | â­ ç®€å• | 10-20s | â­â­â­â­ | â­â­â­â­ |
| **Fly.io** | 3GB/æœˆ | â­â­â­ ä¸­ç­‰ | æ—  | â­â­â­â­â­ | â­â­â­â­ |
| **Vercel** | è¶³å¤Ÿ | â­ ç®€å• | æ—  | â­â­â­â­â­ | â­â­â­â­â­ |

### æµé‡æˆæœ¬ä¼°ç®—

å‡è®¾æœˆè®¿é—®é‡ï¼š

| æµé‡ | Railway æˆæœ¬ | Render æˆæœ¬ | Fly.io æˆæœ¬ |
|------|-------------|------------|------------|
| 1 GB | $0ï¼ˆå…è´¹å†…ï¼‰ | Â¥0 | Â¥0 |
| 10 GB | $5-10 | Â¥0 | Â¥0-30 |
| 100 GB | $20-50 | Â¥0 | Â¥50-150 |

**ç»“è®º**: å¯¹äºä¸­å°å‹é¡¹ç›®ï¼ŒRailway $5/æœˆ è¶³å¤Ÿä½¿ç”¨ã€‚

---

## ğŸ”„ ç»´æŠ¤ä¸æ›´æ–°

### æ—¥å¸¸ç»´æŠ¤

#### 1. ç›‘æ§æœåŠ¡çŠ¶æ€

```bash
# Vercel çŠ¶æ€æ£€æŸ¥
curl -I https://xiaonajisuan.vercel.app

# Railway çŠ¶æ€æ£€æŸ¥
curl https://your-backend.railway.app/api/healthz
```

#### 2. æŸ¥çœ‹æ—¥å¿—

```bash
# Vercel æ—¥å¿—ï¼ˆDashboardï¼‰
Vercel Dashboard â†’ Project â†’ Logs

# Railway æ—¥å¿—
railway logs --tail
```

#### 3. å¤‡ä»½æ•°æ®

```bash
# å¯¼å‡ºæ•°æ®åº“ï¼ˆå¦‚ä½¿ç”¨ SQLiteï¼‰
# é€šè¿‡ Railway Shell
railway run cat /app/pv_consumption.db > backup.db

# å®šæœŸå¯¼å‡º Excel æŠ¥å‘Šä½œä¸ºå¤‡ä»½
```

### ä»£ç æ›´æ–°æµç¨‹

#### æ­¥éª¤ 1: æœ¬åœ°å¼€å‘ä¸æµ‹è¯•

```bash
# 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/new-feature

# 2. å¼€å‘æ–°åŠŸèƒ½
# ... ç¼–ç  ...

# 3. æœ¬åœ°æµ‹è¯•
cd backend && pytest
cd frontend && npm run lint && npm run build

# 4. æäº¤ä»£ç 
git add .
git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"
```

#### æ­¥éª¤ 2: æ¨é€åˆ° GitHub

```bash
# æ¨é€åˆ°è¿œç¨‹ä»“åº“
git push origin feature/new-feature

# åˆ›å»º Pull Requestï¼ˆå¯é€‰ï¼‰
# åœ¨ GitHub ä¸Šåˆ›å»º PRï¼Œè¿›è¡Œä»£ç å®¡æŸ¥
```

#### æ­¥éª¤ 3: è‡ªåŠ¨éƒ¨ç½²

```
GitHub Push
    â†“
Vercel è‡ªåŠ¨æ£€æµ‹ï¼ˆ2-3åˆ†é’Ÿï¼‰
    â”œâ”€ æ„å»ºå‰ç«¯
    â”œâ”€ éƒ¨ç½²åˆ° CDN
    â””â”€ ç”Ÿæˆ Preview URL
    
Railway è‡ªåŠ¨æ£€æµ‹ï¼ˆ3-5åˆ†é’Ÿï¼‰
    â”œâ”€ å®‰è£…ä¾èµ–
    â”œâ”€ å¯åŠ¨æœåŠ¡
    â””â”€ å¥åº·æ£€æŸ¥
```

#### æ­¥éª¤ 4: éªŒè¯éƒ¨ç½²

```bash
# æµ‹è¯• Preview éƒ¨ç½²
# Vercel ä¼šä¸ºæ¯ä¸ª PR/åˆ†æ”¯ç”Ÿæˆé¢„è§ˆ URL
https://xiaonajisuan-git-feature-new-feature-xxx.vercel.app

# æµ‹è¯•åç«¯
curl https://your-backend.railway.app/api/healthz
```

#### æ­¥éª¤ 5: åˆå¹¶åˆ°ä¸»åˆ†æ”¯

```bash
# åˆå¹¶åˆ°ä¸»åˆ†æ”¯ï¼ˆè§¦å‘ç”Ÿäº§éƒ¨ç½²ï¼‰
git checkout main
git merge feature/new-feature
git push origin main
```

### ç¯å¢ƒå˜é‡æ›´æ–°

#### Vercel ç¯å¢ƒå˜é‡æ›´æ–°

```bash
# 1. Vercel Dashboard â†’ Settings â†’ Environment Variables
# 2. ä¿®æ”¹æˆ–æ·»åŠ å˜é‡
# 3. ç‚¹å‡» Save
# 4. æ‰‹åŠ¨è§¦å‘é‡æ–°éƒ¨ç½²ï¼ˆæˆ–æ¨é€ä»£ç ï¼‰
```

#### Railway ç¯å¢ƒå˜é‡æ›´æ–°

```bash
# 1. Railway Dashboard â†’ Service â†’ Variables
# 2. ä¿®æ”¹æˆ–æ·»åŠ å˜é‡
# 3. Railway è‡ªåŠ¨é‡æ–°éƒ¨ç½²ï¼ˆçº¦ 2-3 åˆ†é’Ÿï¼‰
```

### å›æ»šæ“ä½œ

#### Vercel å›æ»š

```bash
# 1. Vercel Dashboard â†’ Deployments
# 2. æ‰¾åˆ°ä¹‹å‰çš„æˆåŠŸéƒ¨ç½²
# 3. ç‚¹å‡» "..." èœå• â†’ "Promote to Production"
```

#### Railway å›æ»š

```bash
# æ–¹æ³• 1: Dashboard å›æ»š
# Railway Dashboard â†’ Deployments â†’ é€‰æ‹©å†å²éƒ¨ç½² â†’ Redeploy

# æ–¹æ³• 2: Git å›æ»š
git revert <commit-hash>
git push origin feature/work-mode-adjustment
# Railway è‡ªåŠ¨éƒ¨ç½²å›æ»šåçš„ä»£ç 
```

### åŸŸåé…ç½®ï¼ˆå¯é€‰ï¼‰

#### æ·»åŠ è‡ªå®šä¹‰åŸŸå

**Vercel è‡ªå®šä¹‰åŸŸå**:

```bash
# 1. Vercel Dashboard â†’ Project â†’ Settings â†’ Domains
# 2. ç‚¹å‡» "Add"
# 3. è¾“å…¥åŸŸåï¼Œä¾‹å¦‚: pv.yourdomain.com
# 4. æŒ‰ç…§æç¤ºé…ç½® DNSï¼ˆæ·»åŠ  CNAME è®°å½•ï¼‰
# 5. ç­‰å¾… DNS ç”Ÿæ•ˆï¼ˆ5-30 åˆ†é’Ÿï¼‰
```

**Railway è‡ªå®šä¹‰åŸŸå**:

```bash
# 1. Railway Dashboard â†’ Service â†’ Settings â†’ Domains
# 2. ç‚¹å‡» "Custom Domain"
# 3. è¾“å…¥åŸŸåï¼Œä¾‹å¦‚: api.yourdomain.com
# 4. æ·»åŠ  CNAME è®°å½•æŒ‡å‘ Railway
# 5. ç­‰å¾…éªŒè¯é€šè¿‡
```

**DNS é…ç½®ç¤ºä¾‹**:

```
ç±»å‹    åç§°              å€¼
-----   ----------------  --------------------------------
CNAME   pv                cname.vercel-dns.com
CNAME   api               your-service.up.railway.app
```

### æ•°æ®åº“è¿ç§»

#### SQLite â†’ PostgreSQL

```bash
# 1. Railway æ·»åŠ  PostgreSQL
Railway Dashboard â†’ New â†’ Database â†’ PostgreSQL

# 2. è·å– DATABASE_URL
# Railway è‡ªåŠ¨ç”Ÿæˆå¹¶æ³¨å…¥ç¯å¢ƒå˜é‡

# 3. æ›´æ–°åç«¯ä»£ç ï¼ˆå·²å…¼å®¹ï¼‰
# backend/app/core/config.py è‡ªåŠ¨å¤„ç†

# 4. æ•°æ®è¿ç§»ï¼ˆä½¿ç”¨å·¥å…·ï¼‰
# æ–¹æ³• 1: pgloader
pgloader pv_consumption.db $DATABASE_URL

# æ–¹æ³• 2: æ‰‹åŠ¨å¯¼å‡º/å¯¼å…¥
sqlite3 pv_consumption.db .dump > dump.sql
psql $DATABASE_URL < dump.sql
```

---

## ğŸ“š é™„å½•

### A. ç›¸å…³æ–‡æ¡£é“¾æ¥

| æ–‡æ¡£ | é“¾æ¥ |
|------|------|
| Vercel å®˜æ–¹æ–‡æ¡£ | https://vercel.com/docs |
| Railway å®˜æ–¹æ–‡æ¡£ | https://docs.railway.app |
| FastAPI æ–‡æ¡£ | https://fastapi.tiangolo.com |
| React æ–‡æ¡£ | https://react.dev |
| Vite æ–‡æ¡£ | https://vitejs.dev |

### B. å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# === æœ¬åœ°å¼€å‘ ===

# å¯åŠ¨åç«¯
cd backend
source venv/bin/activate
uvicorn app.main:app --reload --port 8000

# å¯åŠ¨å‰ç«¯
cd frontend
npm run dev

# è¿è¡Œæµ‹è¯•
cd backend && pytest
cd frontend && npm test

# === Git æ“ä½œ ===

# æäº¤ä»£ç 
git add .
git commit -m "feat: æè¿°"
git push origin feature/work-mode-adjustment

# æŸ¥çœ‹çŠ¶æ€
git status
git log --oneline -10

# === éƒ¨ç½²æ£€æŸ¥ ===

# æµ‹è¯•å‰ç«¯
curl -I https://xiaonajisuan.vercel.app

# æµ‹è¯•åç«¯
curl https://your-backend.railway.app/api/healthz

# æŸ¥çœ‹æ—¥å¿—
railway logs --tail
```

### C. æ•…éšœæ’æŸ¥æ¸…å•

- [ ] **å‰ç«¯æ— æ³•è®¿é—®**
  - [ ] Vercel éƒ¨ç½²çŠ¶æ€æ˜¯å¦ä¸º "Ready"
  - [ ] vercel.json æ˜¯å¦é…ç½®æ­£ç¡®
  - [ ] æ˜¯å¦æœ‰æ„å»ºé”™è¯¯

- [ ] **åç«¯æ— æ³•è®¿é—®**
  - [ ] Railway æœåŠ¡çŠ¶æ€æ˜¯å¦ä¸º "Active"
  - [ ] ç¯å¢ƒå˜é‡æ˜¯å¦é…ç½®å®Œæ•´
  - [ ] æ˜¯å¦ç”Ÿæˆäº†å…¬å¼€åŸŸå
  - [ ] æ—¥å¿—ä¸­æ˜¯å¦æœ‰é”™è¯¯

- [ ] **CORS é”™è¯¯**
  - [ ] Railway CORS_ORIGINS æ˜¯å¦åŒ…å« Vercel URL
  - [ ] å‰ç«¯è¯·æ±‚çš„ URL æ˜¯å¦æ­£ç¡®
  - [ ] åç«¯ config.py çš„ allowed_origins é…ç½®

- [ ] **API è¯·æ±‚å¤±è´¥**
  - [ ] VITE_API_URL ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®
  - [ ] Vercel æ˜¯å¦é‡æ–°éƒ¨ç½²
  - [ ] åç«¯è·¯ç”±æ˜¯å¦æ­£ç¡®ï¼ˆ/api å‰ç¼€ï¼‰

### D. è”ç³»æ”¯æŒ

| é—®é¢˜ç±»å‹ | è”ç³»æ–¹å¼ |
|---------|---------|
| Vercel éƒ¨ç½²é—®é¢˜ | https://vercel.com/support |
| Railway éƒ¨ç½²é—®é¢˜ | https://railway.app/help |
| é¡¹ç›® Bug æŠ¥å‘Š | GitHub Issues |
| åŠŸèƒ½å»ºè®® | GitHub Discussions |

---

## ğŸ‰ éƒ¨ç½²å®Œæˆæ£€æŸ¥

å®Œæˆéƒ¨ç½²åï¼Œç¡®è®¤ä»¥ä¸‹æ‰€æœ‰é¡¹ç›®ï¼š

### å‰ç«¯æ£€æŸ¥

- [ ] Vercel é¡¹ç›®å·²åˆ›å»º
- [ ] æ„å»ºæˆåŠŸï¼Œæ— é”™è¯¯
- [ ] ç”Ÿäº§ç¯å¢ƒ URL å¯è®¿é—®ï¼š`https://xiaonajisuan.vercel.app`
- [ ] æ‰€æœ‰è·¯ç”±æ­£å¸¸ï¼ˆ/, /data-import, /parameters ç­‰ï¼‰
- [ ] ç¯å¢ƒå˜é‡ VITE_API_URL å·²é…ç½®

### åç«¯æ£€æŸ¥

- [ ] Railway æœåŠ¡å·²åˆ›å»º
- [ ] éƒ¨ç½²æˆåŠŸï¼ŒçŠ¶æ€æ˜¾ç¤º "Active"
- [ ] æ‰€æœ‰ç¯å¢ƒå˜é‡å·²é…ç½®ï¼ˆDATABASE_URL, CORS_ORIGINS ç­‰ï¼‰
- [ ] å…¬å¼€åŸŸåå·²ç”Ÿæˆ
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡ï¼š`/api/healthz` è¿”å› 200

### è¿æ¥æ£€æŸ¥

- [ ] å‰ç«¯èƒ½æˆåŠŸè°ƒç”¨åç«¯ API
- [ ] æ—  CORS é”™è¯¯
- [ ] æ•°æ®èƒ½æ­£å¸¸åŠ è½½
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸

### åŠŸèƒ½æ£€æŸ¥

- [ ] å…‰ä¼æ•°æ®å¯¼å…¥åŠŸèƒ½æ­£å¸¸
- [ ] è´Ÿè·æ•°æ®å¯¼å…¥åŠŸèƒ½æ­£å¸¸
- [ ] åˆ†æ—¶ç”µä»·é…ç½®æ­£å¸¸
- [ ] æ¶ˆçº³è®¡ç®—åŠŸèƒ½æ­£å¸¸
- [ ] å›¾è¡¨å±•ç¤ºæ­£å¸¸
- [ ] æŠ¥å‘Šå¯¼å‡ºåŠŸèƒ½æ­£å¸¸

---

## ğŸš€ æ€»ç»“

æ­å–œï¼ä½ å·²ç»å®Œæˆäº†å…‰ä¼ç”µç«™æ¶ˆçº³è®¡ç®—å¹³å°çš„å®Œæ•´éƒ¨ç½²ã€‚

### éƒ¨ç½²æ¶æ„æ€»ç»“

```
âœ… å‰ç«¯: Vercel (https://xiaonajisuan.vercel.app)
   â”œâ”€ å…¨çƒ CDN åŠ é€Ÿ
   â”œâ”€ è‡ªåŠ¨ HTTPS
   â”œâ”€ æŒç»­éƒ¨ç½²
   â””â”€ å…è´¹æ‰˜ç®¡

âœ… åç«¯: Railway (https://your-backend.railway.app)
   â”œâ”€ å®Œæ•´ Python è¿è¡Œæ—¶
   â”œâ”€ SQLite æ•°æ®åº“æŒä¹…åŒ–
   â”œâ”€ æ–‡ä»¶å­˜å‚¨æ”¯æŒ
   â””â”€ $5/æœˆå…è´¹é¢åº¦

âœ… è¿æ¥: CORS + Environment Variables
   â”œâ”€ VITE_API_URL æŒ‡å‘ Railway
   â”œâ”€ CORS_ORIGINS åŒ…å« Vercel
   â””â”€ è·¨åŸŸè¯·æ±‚æ­£å¸¸
```

### å…³é”®è¦ç‚¹

1. **å‰åç«¯åˆ†ç¦»éƒ¨ç½²**: Vercel æ‰˜ç®¡é™æ€å‰ç«¯ï¼ŒRailway è¿è¡ŒåŠ¨æ€åç«¯
2. **ç¯å¢ƒå˜é‡é…ç½®**: VITE_API_URL (Vercel) å’Œ CORS_ORIGINS (Railway) æ˜¯å…³é”®
3. **è‡ªåŠ¨éƒ¨ç½²**: æ¨é€åˆ° GitHub è‡ªåŠ¨è§¦å‘ Vercel å’Œ Railway éƒ¨ç½²
4. **æˆæœ¬æ§åˆ¶**: Vercel å…è´¹ + Railway $5/æœˆ = æ€»è®¡çº¦ Â¥35/æœˆ

### ä¸‹ä¸€æ­¥å»ºè®®

1. ğŸ”’ **å®‰å…¨åŠ å›º**: æ·»åŠ  API è®¤è¯ã€Rate Limiting
2. ğŸ“Š **ç›‘æ§å‘Šè­¦**: é…ç½® Vercel Analyticsã€Sentry é”™è¯¯è¿½è¸ª
3. ğŸ—„ï¸ **æ•°æ®åº“å‡çº§**: ä» SQLite è¿ç§»åˆ° PostgreSQL
4. ğŸŒ **è‡ªå®šä¹‰åŸŸå**: é…ç½®è‡ªå·±çš„åŸŸåï¼ˆå¯é€‰ï¼‰
5. âš¡ **æ€§èƒ½ä¼˜åŒ–**: ä»£ç åˆ†å‰²ã€ç¼“å­˜ç­–ç•¥ã€CDN ä¼˜åŒ–

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2025å¹´11æœˆ2æ—¥  
**ç»´æŠ¤è€…**: GitHub Copilot  
**è®¸å¯è¯**: MIT

---

**æœ‰é—®é¢˜ï¼Ÿ** æŸ¥çœ‹ [é—®é¢˜æ’æŸ¥æŒ‡å—](#é—®é¢˜æ’æŸ¥æŒ‡å—) æˆ–æäº¤ GitHub Issueã€‚

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼** ğŸ‰
